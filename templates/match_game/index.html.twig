{% extends 'base.html.twig' %}

{% block title %}Match Center - Esports League{% endblock %}

{% block body %}
<style>
/* =========================
   INNOVATIVE ESPORTS THEME
=========================*/
:root {
    --bg-dark: #020617;
    --card-bg: rgba(15, 23, 42, 0.65);
    --border-color: rgba(255, 255, 255, 0.08);
    --text-primary: #f8fafc;
    --text-secondary: #94a3b8;
    
    /* Neon Palette */
    --neon-blue: #3b82f6;
    --neon-purple: #8b5cf6;
    --neon-pink: #ec4899;
    --neon-green: #10b981;
}

body {
    background: var(--bg-dark);
    color: var(--text-primary);
    font-family: 'Inter', 'Segoe UI', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
}

/* Background Effects */
.page-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    background: 
        radial-gradient(circle at 10% 20%, rgba(59, 130, 246, 0.15) 0%, transparent 40%),
        radial-gradient(circle at 90% 80%, rgba(236, 72, 153, 0.1) 0%, transparent 40%);
}

/* =========================
   HERO SECTION
=========================*/
.hero-section {
    position: relative;
    padding: 100px 20px 60px;
    text-align: center;
    overflow: hidden;
}

.hero-title {
    font-size: clamp(3rem, 8vw, 5rem);
    font-weight: 900;
    text-transform: uppercase;
    line-height: 1;
    margin-bottom: 20px;
    letter-spacing: -2px;
    background: linear-gradient(135deg, #fff 30%, var(--text-secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    position: relative;
    z-index: 10;
}

.hero-subtitle {
    font-size: 1.2rem;
    color: var(--text-secondary);
    max-width: 600px;
    margin: 0 auto 40px;
    position: relative;
    z-index: 10;
}

.hero-actions {
    position: relative;
    z-index: 10;
}

/* =========================
   MATCH GRID
=========================*/
.matches-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 40px 20px 100px;
}

.matches-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
    gap: 30px;
}

/* Innovative Match Card */
.match-card {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 24px;
    padding: 0;
    position: relative;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    backdrop-filter: blur(20px);
}

.match-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple), var(--neon-pink));
    opacity: 0;
    transition: opacity 0.3s;
}

.match-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.5);
    border-color: rgba(255, 255, 255, 0.15);
}

.match-card:hover::before {
    opacity: 1;
}

/* Card Header */
.card-header {
    padding: 25px 25px 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid rgba(255, 255, 255, 0.03);
}

.tournament-tag {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--neon-blue);
    background: rgba(59, 130, 246, 0.1);
    padding: 6px 12px;
    border-radius: 99px;
    border: 1px solid rgba(59, 130, 246, 0.2);
}

.game-tag {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--neon-purple);
    background: rgba(139, 92, 246, 0.1);
    padding: 6px 12px;
    border-radius: 99px;
    border: 1px solid rgba(139, 92, 246, 0.2);
    display: flex;
    align-items: center;
    gap: 5px;
}

.match-date {
    font-size: 0.85rem;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    gap: 6px;
}

/* Faceoff Section */
.card-body {
    padding: 30px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 15px;
}

.team-info {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    flex: 1;
}

.team-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 10px;
    border: 1px solid var(--border-color);
    font-size: 1.5rem;
    color: var(--text-primary);
}

.team-name {
    font-weight: 700;
    font-size: 1rem;
    line-height: 1.2;
}

.vs-badge {
    font-size: 1.5rem;
    font-weight: 900;
    color: var(--text-secondary);
    opacity: 0.3;
    font-style: italic;
}

.score-badge {
    background: rgba(0, 0, 0, 0.3);
    padding: 8px 16px;
    border-radius: 12px;
    font-weight: 800;
    font-size: 1.2rem;
    letter-spacing: 2px;
    border: 1px solid var(--border-color);
    color: var(--text-primary);
    min-width: 80px;
    text-align: center;
}

/* Card Footer */
.card-footer {
    padding: 15px 25px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.status-indicator {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.85rem;
    font-weight: 600;
}

.status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
}
.status-finished .status-dot { background: var(--neon-green); box-shadow: 0 0 10px var(--neon-green); }
.status-finished span { color: var(--neon-green); }

.status-progress .status-dot { background: #f59e0b; box-shadow: 0 0 10px #f59e0b; }
.status-progress span { color: #f59e0b; }

.status-pending .status-dot { background: var(--text-secondary); }
.status-pending span { color: var(--text-secondary); }


/* Buttons */
.btn-action {
    width: 36px;
    height: 36px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.05);
    color: var(--text-secondary);
    transition: all 0.2s;
    text-decoration: none;
    border: 1px solid transparent;
}
.btn-action:hover {
    background: var(--text-primary);
    color: var(--bg-dark);
}

.btn-cta {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 16px 32px;
    background: linear-gradient(135deg, var(--neon-purple), var(--neon-pink));
    color: white;
    font-weight: 700;
    border-radius: 16px;
    text-decoration: none;
    transition: all 0.3s;
    box-shadow: 0 10px 25px -5px rgba(236, 72, 153, 0.4);
    border: 1px solid rgba(255, 255, 255, 0.1);
}
.btn-cta:hover {
    transform: translateY(-3px);
    box-shadow: 0 20px 40px -5px rgba(236, 72, 153, 0.5);
}

/* Empty State */
.empty-wrapper {
    grid-column: 1 / -1;
    text-align: center;
    padding: 100px 20px;
    background: var(--card-bg);
    border-radius: 30px;
    border: 1px dashed var(--border-color);
}
.empty-icon {
    font-size: 4rem;
    color: var(--text-secondary);
    opacity: 0.2;
    margin-bottom: 20px;
}

/* Classement */
.section-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 24px;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 12px;
}
.section-title i { color: var(--neon-yellow, #eab308); }
.classement-table-wrapper {
    background: var(--card-bg);
    border-radius: 16px;
    border: 1px solid var(--border-color);
    overflow-x: auto;
    margin-bottom: 40px;
}
.classement-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.95rem;
}
.classement-table th, .classement-table td {
    padding: 14px 16px;
    text-align: center;
    border-bottom: 1px solid var(--border-color);
}
.classement-table th {
    background: rgba(255,255,255,0.03);
    font-weight: 700;
    color: var(--text-secondary);
    text-transform: uppercase;
    font-size: 0.75rem;
    letter-spacing: 0.5px;
}
.classement-table tbody tr:hover {
    background: rgba(255,255,255,0.02);
}
.classement-table .rang { font-weight: 700; color: var(--neon-blue); }
.classement-table .equipe { text-align: left; font-weight: 600; }
.classement-table .equipe a { color: var(--text-primary); text-decoration: none; }
.classement-table .equipe a:hover { color: var(--neon-purple); }
.classement-table .v { color: var(--neon-green); }
.classement-table .p { color: var(--neon-pink); }
.classement-table .diff { font-weight: 600; }
.classement-table .pts { color: var(--neon-yellow, #eab308); }
.classement-empty {
    color: var(--text-secondary);
    text-align: center;
    padding: 40px 20px;
    background: var(--card-bg);
    border-radius: 16px;
    border: 1px dashed var(--border-color);
}

/* Responsive */
@media (max-width: 600px) {
    .matches-grid { grid-template-columns: 1fr; }
    .hero-title { font-size: 2.5rem; }
    .classement-table th, .classement-table td { padding: 10px 8px; font-size: 0.85rem; }
}
</style>

<div class="page-background"></div>

<!-- HERO -->
<div class="hero-section">
    <h1 class="hero-title">{% if tournoi %}{{ tournoi.nom }}{% else %}Match Center{% endif %}</h1>
    <p class="hero-subtitle">{% if tournoi %}Classement et matchs du tournoi{% else %}Track every battle, every score, and every victory in real-time.{% endif %}</p>
</div>

<!-- CLASSEMENT (pour vue tournoi : affiché dès le début avec toutes les équipes inscrites) -->
{% if tournoi is defined and tournoi %}
<div class="matches-container">
    <h2 class="section-title"><i class="fas fa-trophy"></i> Classement</h2>
    {% if classement|default([])|length > 0 %}
    <div class="classement-table-wrapper">
        <table class="classement-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Équipe</th>
                    <th>MJ</th>
                    <th>V</th>
                    <th>N</th>
                    <th>P</th>
                    <th>BP</th>
                    <th>BC</th>
                    <th>Diff</th>
                    <th>Pts</th>
                </tr>
            </thead>
            <tbody>
                {% for row in classement %}
                <tr>
                    <td class="rang">{{ row.rang }}</td>
                    <td class="equipe"><a href="{{ path('app_equipe_show', {'id': row.equipe.id}) }}">{{ row.equipe.nom }}</a></td>
                    <td>{{ row.mj }}</td>
                    <td class="v">{{ row.v }}</td>
                    <td class="n">{{ row.n }}</td>
                    <td class="p">{{ row.p }}</td>
                    <td>{{ row.bp }}</td>
                    <td>{{ row.bc }}</td>
                    <td class="diff">{{ row.diff >= 0 ? '+' ~ row.diff : row.diff }}</td>
                    <td class="pts"><strong>{{ row.pts }}</strong></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <p class="classement-empty">Aucune équipe inscrite pour l'instant. Le classement s'affichera ici dès que des équipes seront inscrites au tournoi.</p>
    {% endif %}
</div>
{% endif %}

<!-- MATCHES -->
<div class="matches-container">
    <h2 class="section-title" {% if tournoi %}style="margin-top:40px;"{% endif %}><i class="fas fa-gamepad"></i> Matchs</h2>
    {% if match_games|length > 0 %}
        <div class="matches-grid">
            {% for match_game in match_games %}
            <div class="match-card">
                
                <!-- HEADER -->
                <div class="card-header">
                    <div style="display:flex; gap:10px; align-items:center;">
                        {% if not tournoi %}
                            <span class="tournament-tag">{{ match_game.tournoi.nom }}</span>
                        {% endif %}
                        {% if match_game.tournoi.jeu is defined and match_game.tournoi.jeu %}
                            <span class="game-tag"><i class="fas fa-gamepad"></i> {{ match_game.tournoi.jeu.nom }}</span>
                        {% endif %}
                    <div class="match-date">
                        <i class="far fa-clock"></i>
                        {{ match_game.dateMatch|date('d M, H:i') }}
                    </div>
                </div>

                <!-- BODY -->
                <div class="card-body">
                    <!-- Team 1 -->
                    <div class="team-info">
                        <div class="team-avatar">
                            <i class="fas fa-gamepad"></i>
                        </div>
                        <div class="team-name">{{ match_game.equipe1.nom }}</div>
                    </div>

                    <!-- Center -->
                    {% if match_game.statut == 'Finished' or match_game.statut == 'In Progress' %}
                        <div class="score-badge">
                            {{ match_game.scoreTeam1 }} - {{ match_game.scoreTeam2 }}
                        </div>
                    {% else %}
                        <div class="vs-badge">VS</div>
                    {% endif %}

                    <!-- Team 2 -->
                    <div class="team-info">
                        <div class="team-avatar">
                            <i class="fas fa-headset"></i>
                        </div>
                        <div class="team-name">{{ match_game.equipe2.nom }}</div>
                    </div>
                </div>

                <!-- FOOTER -->
                <div class="card-footer">
                    <!-- Status -->
                    <div class="status-indicator status-{{ match_game.statut|lower|replace({' ': '-'}) == 'scheduled' ? 'pending' : match_game.statut|lower|replace({' ': '-'}) }}">
                        <div class="status-dot"></div>
                        <span>{{ match_game.statut }}</span>
                    </div>

                    <!-- Action -->
                    <a href="{{ path('app_match_game_show', {'id': match_game.id}) }}" class="btn-action" title="View Details">
                        <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-wrapper">
            <i class="fas fa-gamepad empty-icon"></i>
            <h2 style="margin-bottom: 10px;">No Matches Found</h2>
            <p style="color: var(--text-secondary);">The arena is empty. Start a new competition.</p>
        </div>
    {% endif %}
</div>

{% endblock %}
