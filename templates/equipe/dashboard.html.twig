{% extends 'base.html.twig' %}
{% block title %}Team Dashboard{% endblock %}

{% block body %}
<div class="team-dashboard">

    <!-- HEADER -->
    <section class="team-header">
        <div style="display:flex;align-items:center;gap:16px;">
            {% if team.logo %}
                <img src="{{ asset('uploads/teams/' ~ team.logo) }}" alt="{{ team.nom }}" style="width:72px;height:72px;border-radius:8px;object-fit:cover;">
            {% else %}
                <img src="{{ asset('img/logo.png') }}" alt="{{ team.nom }}" style="width:72px;height:72px;border-radius:8px;object-fit:cover;">
            {% endif %}
            <div>
                <h1>{{ team.nom }}</h1>
                <span class="role {{ membership.role }}">
                    {{ membership.role }}
                </span>
            </div>
        </div>

        <div class="team-actions">
            {% if membership.role == 'LEADER' %}
                <a href="{{ path('app_equipe_membres', {id: team.id}) }}">Membres</a>
                <a href="{{ path('app_equipe_edit', {id: team.id}) }}">Settings</a>
            {% elseif membership.role == 'MEMBER' %}
                <form method="post" action="{{ path('app_equipe_leave', {id: team.id}) }}" onsubmit="return confirm('Are you sure you want to leave this team?');" style="display:inline;">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ team.id) }}">
                    <button type="submit" class="btn-dashboard-action">Leave Team</button>
                </form>
            {% endif %}
        </div>
    </section>

    <!-- STATS -->
    <section class="team-stats">
        <div class="stat">
            <h3>{{ team.members|length }}</h3>
            <p>Members</p>
        </div>
        <div class="stat">
            <h3>{{ totalMatches }}</h3>
            <p>Matches</p>
        </div>
        <div class="stat">
            <h3>{{ wins }}</h3>
            <p>Wins</p>
        </div>
        <div class="stat">
            <h3>{{ winRate }}%</h3>
            <p>Win rate</p>
        </div>
    </section>

    <!-- MEMBERS -->
    <section class="team-members">
        <h2>Members</h2>

        <div class="members-grid">
            {% for member in team.members %}
                <div class="member-card">
                    <div class="avatar"></div>
                    <p>{{ member.nom ?: member.userIdentifier }}</p>
                </div>
            {% endfor %}
        </div>
    </section>

    <!-- TOURNAMENTS -->
    <section class="team-tournaments">
        <h2>Tournaments</h2>

        <div class="tournament-card">
            <h3>Spring Cup</h3>
            <p>Status : Active</p>
        </div>
    </section>

</div>
{% endblock %}

